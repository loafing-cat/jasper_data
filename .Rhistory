theme_clean() +
theme(axis.text.x = element_text(angle = 45, hjust = 1),legend.position = "none")
p2
# dynamically save ggplot
ggsave(
filename = paste0(here("images", "line", "jasper_weight_daily_time_series"), format(Sys.Date(), "_%Y_%m_%d"), ".png"),
plot = p2,
dpi = 600,
width = 14,
height = 8
)
# time-series of daily weights
p2 <- daily_weight %>%
filter(!is.na(`Weight (lbs)`)) %>% # filter after May 5th, 2024 and exclude NAs
ggplot(aes(x = Day, y = `Weight (lbs)`)) +
geom_hline(aes(yintercept = 11), color = "red", linetype = "dashed", size = 1.5) +
geom_hline(aes(yintercept = (11 + 12) / 2), color = "orange", linetype = "dashed", size = 1.5) + # healthy weight between [11.25, 12] (lbs) add average of two intervals as reference line
geom_hline(aes(yintercept = 12), color = "green", linetype = "dashed", size = 1.5) +
geom_hline(aes(yintercept = 9), color = "red", linetype = "dashed", size = 1.5) +
# geom_vline(data = weeks, aes(xintercept = Day), linetype = "dashed", color = "lightgrey") +
geom_point(size = 2, color = "black") +
geom_line(size = 1.0, color = "black") +
geom_line(aes(y = rollmean(`Weight (lbs)`, 7, na.pad = TRUE)), color = "blue", linetype = "dashed", size = 0.7) +
geom_point(aes(color = factor(is_week_max_date)), size = 2) +
geom_text(data = subset(daily_weight, Day == as.Date("2024-05-12")),
aes(label = "Red dots indicates end of week", x = Day - 3, y = `Weight (lbs)` + 0.5), size = 3, vjust = 0) +
geom_segment(data = subset(daily_weight, Day == as.Date("2024-05-07")),
aes(xend = Day - 1, yend = `Weight (lbs)`, x = Day - 4, y = `Weight (lbs)` + 0.4),
arrow = arrow(type = "closed", length = unit(0.1, "inches"), ends = "last"), color = "black") +
geom_text(data = subset(daily_weight, Day == as.Date("2024-05-20")),
aes(label = "Period of stinky diarrheas due to antiviral :(", x = Day,  y = 10.65), size = 2, vjust = 0) +
geom_segment(data = subset(daily_weight, Day == as.Date("2024-05-20")),
aes(xend = Day, yend = `Weight (lbs)` + 0.50, x = Day, y = 10.55),
arrow = arrow(type = "closed", length = unit(0.1, "inches"), ends = "last"), color = "black") +
labs(x = "Date",
y = "Weight (lbs)",
title = "Jasper's Daily Weight (lbs)",
subtitle = "Healthy Weight [11, 12]; 11.5 is average of the interval"
) +
scale_colour_manual(values = c("Y" = "red", "N" = "black")) +
scale_y_continuous(expand = c(0, 0), limits = c(7, 15),
breaks = c(7, 8, 9, 10, 11, 11.5, 12, 13, 14, 15)) +
# scale_y_continuous(expand = c(0, 0), limits = c(0, 15)) +
scale_x_date(date_breaks = "4 days", date_labels = "%m/%d/%Y") +
theme_clean() +
theme(axis.text.x = element_text(angle = 45, hjust = 1),legend.position = "none")
p2
# time-series of daily weights
p2 <- daily_weight %>%
filter(!is.na(`Weight (lbs)`)) %>% # filter after May 5th, 2024 and exclude NAs
ggplot(aes(x = Day, y = `Weight (lbs)`)) +
geom_hline(aes(yintercept = 11), color = "red", linetype = "dashed", size = 1.5) +
geom_hline(aes(yintercept = (11 + 12) / 2), color = "orange", linetype = "dashed", size = 1.5) + # healthy weight between [11.25, 12] (lbs) add average of two intervals as reference line
geom_hline(aes(yintercept = 12), color = "green", linetype = "dashed", size = 1.5) +
geom_hline(aes(yintercept = 9), color = "red", linetype = "dashed", size = 1.5) +
# geom_vline(data = weeks, aes(xintercept = Day), linetype = "dashed", color = "lightgrey") +
geom_point(size = 2, color = "black") +
geom_line(size = 1.0, color = "black") +
geom_line(aes(y = rollmean(`Weight (lbs)`, 7, na.pad = TRUE)), color = "blue", linetype = "dashed", size = 0.7) +
geom_point(aes(color = factor(is_week_max_date)), size = 2) +
geom_text(data = subset(daily_weight, Day == as.Date("2024-05-12")),
aes(label = "Red dots indicates end of week", x = Day - 3, y = `Weight (lbs)` + 0.5), size = 3, vjust = 0) +
geom_segment(data = subset(daily_weight, Day == as.Date("2024-05-07")),
aes(xend = Day, yend = `Weight (lbs)`, x = Day - 4, y = `Weight (lbs)` + 0.4),
arrow = arrow(type = "closed", length = unit(0.1, "inches"), ends = "last"), color = "black") +
geom_text(data = subset(daily_weight, Day == as.Date("2024-05-20")),
aes(label = "Period of stinky diarrheas due to antiviral :(", x = Day,  y = 10.65), size = 2, vjust = 0) +
geom_segment(data = subset(daily_weight, Day == as.Date("2024-05-20")),
aes(xend = Day, yend = `Weight (lbs)` + 0.50, x = Day, y = 10.55),
arrow = arrow(type = "closed", length = unit(0.1, "inches"), ends = "last"), color = "black") +
labs(x = "Date",
y = "Weight (lbs)",
title = "Jasper's Daily Weight (lbs)",
subtitle = "Healthy Weight [11, 12]; 11.5 is average of the interval"
) +
scale_colour_manual(values = c("Y" = "red", "N" = "black")) +
scale_y_continuous(expand = c(0, 0), limits = c(7, 15),
breaks = c(7, 8, 9, 10, 11, 11.5, 12, 13, 14, 15)) +
# scale_y_continuous(expand = c(0, 0), limits = c(0, 15)) +
scale_x_date(date_breaks = "4 days", date_labels = "%m/%d/%Y") +
theme_clean() +
theme(axis.text.x = element_text(angle = 45, hjust = 1),legend.position = "none")
p2
# time-series of daily weights
p2 <- daily_weight %>%
filter(!is.na(`Weight (lbs)`)) %>% # filter after May 5th, 2024 and exclude NAs
ggplot(aes(x = Day, y = `Weight (lbs)`)) +
geom_hline(aes(yintercept = 11), color = "red", linetype = "dashed", size = 1.5) +
geom_hline(aes(yintercept = (11 + 12) / 2), color = "orange", linetype = "dashed", size = 1.5) + # healthy weight between [11.25, 12] (lbs) add average of two intervals as reference line
geom_hline(aes(yintercept = 12), color = "green", linetype = "dashed", size = 1.5) +
geom_hline(aes(yintercept = 9), color = "red", linetype = "dashed", size = 1.5) +
# geom_vline(data = weeks, aes(xintercept = Day), linetype = "dashed", color = "lightgrey") +
geom_point(size = 2, color = "black") +
geom_line(size = 1.0, color = "black") +
geom_line(aes(y = rollmean(`Weight (lbs)`, 7, na.pad = TRUE)), color = "blue", linetype = "dashed", size = 0.7) +
geom_point(aes(color = factor(is_week_max_date)), size = 2) +
geom_text(data = subset(daily_weight, Day == as.Date("2024-05-12")),
aes(label = "Red dots indicates end of week", x = Day - 3, y = `Weight (lbs)` + 0.5), size = 3, vjust = 0) +
geom_segment(data = subset(daily_weight, Day == as.Date("2024-05-07")),
aes(xend = Day, yend = `Weight (lbs)`, x = Day - 4, y = `Weight (lbs)` + 0.4),
arrow = arrow(type = "closed", length = unit(0.1, "inches"), ends = "last"), color = "black") +
geom_text(data = subset(daily_weight, Day == as.Date("2024-05-20")),
aes(label = "Period of stinky diarrheas due to antiviral :(", x = Day,  y = 10.65), size = 2, vjust = 0) +
geom_segment(data = subset(daily_weight, Day == as.Date("2024-05-20")),
aes(xend = Day+15, yend = `Weight (lbs)` + 0.50, x = Day, y = 10.55),
arrow = arrow(type = "closed", length = unit(0.1, "inches"), ends = "last"), color = "black") +
labs(x = "Date",
y = "Weight (lbs)",
title = "Jasper's Daily Weight (lbs)",
subtitle = "Healthy Weight [11, 12]; 11.5 is average of the interval"
) +
scale_colour_manual(values = c("Y" = "red", "N" = "black")) +
scale_y_continuous(expand = c(0, 0), limits = c(7, 15),
breaks = c(7, 8, 9, 10, 11, 11.5, 12, 13, 14, 15)) +
# scale_y_continuous(expand = c(0, 0), limits = c(0, 15)) +
scale_x_date(date_breaks = "4 days", date_labels = "%m/%d/%Y") +
theme_clean() +
theme(axis.text.x = element_text(angle = 45, hjust = 1),legend.position = "none")
p2
# time-series of daily weights
p2 <- daily_weight %>%
filter(!is.na(`Weight (lbs)`)) %>% # filter after May 5th, 2024 and exclude NAs
ggplot(aes(x = Day, y = `Weight (lbs)`)) +
geom_hline(aes(yintercept = 11), color = "red", linetype = "dashed", size = 1.5) +
geom_hline(aes(yintercept = (11 + 12) / 2), color = "orange", linetype = "dashed", size = 1.5) + # healthy weight between [11.25, 12] (lbs) add average of two intervals as reference line
geom_hline(aes(yintercept = 12), color = "green", linetype = "dashed", size = 1.5) +
geom_hline(aes(yintercept = 9), color = "red", linetype = "dashed", size = 1.5) +
# geom_vline(data = weeks, aes(xintercept = Day), linetype = "dashed", color = "lightgrey") +
geom_point(size = 2, color = "black") +
geom_line(size = 1.0, color = "black") +
geom_line(aes(y = rollmean(`Weight (lbs)`, 7, na.pad = TRUE)), color = "blue", linetype = "dashed", size = 0.7) +
geom_point(aes(color = factor(is_week_max_date)), size = 2) +
geom_text(data = subset(daily_weight, Day == as.Date("2024-05-12")),
aes(label = "Red dots indicates end of week", x = Day - 3, y = `Weight (lbs)` + 0.5), size = 3, vjust = 0) +
geom_segment(data = subset(daily_weight, Day == as.Date("2024-05-07")),
aes(xend = Day - 1, yend = `Weight (lbs)`, x = Day - 4, y = `Weight (lbs)` + 0.4),
arrow = arrow(type = "closed", length = unit(0.1, "inches"), ends = "last"), color = "black") +
geom_text(data = subset(daily_weight, Day == as.Date("2024-05-20")),
aes(label = "Period of stinky diarrheas due to antiviral :(", x = Day,  y = 10.65), size = 2, vjust = 0) +
geom_segment(data = subset(daily_weight, Day == as.Date("2024-05-20")),
aes(xend = Day, yend = `Weight (lbs)` + 0.50, x = Day, y = 10.55),
arrow = arrow(type = "closed", length = unit(0.1, "inches"), ends = "last"), color = "black") +
labs(x = "Date",
y = "Weight (lbs)",
title = "Jasper's Daily Weight (lbs)",
subtitle = "Healthy Weight [11, 12]; 11.5 is average of the interval"
) +
scale_colour_manual(values = c("Y" = "red", "N" = "black")) +
scale_y_continuous(expand = c(0, 0), limits = c(7, 15),
breaks = c(7, 8, 9, 10, 11, 11.5, 12, 13, 14, 15)) +
# scale_y_continuous(expand = c(0, 0), limits = c(0, 15)) +
scale_x_date(date_breaks = "4 days", date_labels = "%m/%d/%Y") +
theme_clean() +
theme(axis.text.x = element_text(angle = 45, hjust = 1),legend.position = "none")
p2
# time-series of daily weights
p2 <- daily_weight %>%
filter(!is.na(`Weight (lbs)`)) %>% # filter after May 5th, 2024 and exclude NAs
ggplot(aes(x = Day, y = `Weight (lbs)`)) +
geom_hline(aes(yintercept = 11), color = "red", linetype = "dashed", size = 1.5) +
geom_hline(aes(yintercept = (11 + 12) / 2), color = "orange", linetype = "dashed", size = 1.5) + # healthy weight between [11.25, 12] (lbs) add average of two intervals as reference line
geom_hline(aes(yintercept = 12), color = "green", linetype = "dashed", size = 1.5) +
geom_hline(aes(yintercept = 9), color = "red", linetype = "dashed", size = 1.5) +
# geom_vline(data = weeks, aes(xintercept = Day), linetype = "dashed", color = "lightgrey") +
geom_point(size = 2, color = "black") +
geom_line(size = 1.0, color = "black") +
geom_line(aes(y = rollmean(`Weight (lbs)`, 7, na.pad = TRUE)), color = "blue", linetype = "dashed", size = 0.7) +
geom_point(aes(color = factor(is_week_max_date)), size = 2) +
geom_text(data = subset(daily_weight, Day == as.Date("2024-05-12")),
aes(label = "Red dots indicates end of week", x = Day - 3, y = `Weight (lbs)` + 0.5), size = 3, vjust = 0) +
geom_segment(data = subset(daily_weight, Day == as.Date("2024-05-07")),
aes(xend = Day, yend = `Weight (lbs)`, x = Day - 4, y = `Weight (lbs)` + 0.4),
arrow = arrow(type = "closed", length = unit(0.1, "inches"), ends = "last"), color = "black") +
geom_text(data = subset(daily_weight, Day == as.Date("2024-05-20")),
aes(label = "Period of stinky diarrheas due to antiviral :(", x = Day,  y = 10.65), size = 2, vjust = 0) +
geom_segment(data = subset(daily_weight, Day == as.Date("2024-05-20")),
aes(xend = Day, yend = `Weight (lbs)` + 0.50, x = Day, y = 10.55),
arrow = arrow(type = "closed", length = unit(0.1, "inches"), ends = "last"), color = "black") +
labs(x = "Date",
y = "Weight (lbs)",
title = "Jasper's Daily Weight (lbs)",
subtitle = "Healthy Weight [11, 12]; 11.5 is average of the interval"
) +
scale_colour_manual(values = c("Y" = "red", "N" = "black")) +
scale_y_continuous(expand = c(0, 0), limits = c(7, 15),
breaks = c(7, 8, 9, 10, 11, 11.5, 12, 13, 14, 15)) +
# scale_y_continuous(expand = c(0, 0), limits = c(0, 15)) +
scale_x_date(date_breaks = "4 days", date_labels = "%m/%d/%Y") +
theme_clean() +
theme(axis.text.x = element_text(angle = 45, hjust = 1),legend.position = "none")
p2
# time-series of daily weights
p2 <- daily_weight %>%
filter(!is.na(`Weight (lbs)`)) %>% # filter after May 5th, 2024 and exclude NAs
ggplot(aes(x = Day, y = `Weight (lbs)`)) +
geom_hline(aes(yintercept = 11), color = "red", linetype = "dashed", size = 1.5) +
geom_hline(aes(yintercept = (11 + 12) / 2), color = "orange", linetype = "dashed", size = 1.5) + # healthy weight between [11.25, 12] (lbs) add average of two intervals as reference line
geom_hline(aes(yintercept = 12), color = "green", linetype = "dashed", size = 1.5) +
geom_hline(aes(yintercept = 9), color = "red", linetype = "dashed", size = 1.5) +
# geom_vline(data = weeks, aes(xintercept = Day), linetype = "dashed", color = "lightgrey") +
geom_point(size = 2, color = "black") +
geom_line(size = 1.0, color = "black") +
geom_line(aes(y = rollmean(`Weight (lbs)`, 7, na.pad = TRUE)), color = "blue", linetype = "dashed", size = 0.7) +
geom_point(aes(color = factor(is_week_max_date)), size = 2) +
geom_text(data = subset(daily_weight, Day == as.Date("2024-05-12")),
aes(label = "Red dots indicates end of week", x = Day - 3, y = `Weight (lbs)` + 0.5), size = 3, vjust = 0) +
geom_segment(data = subset(daily_weight, Day == as.Date("2024-05-07")),
aes(xend = Day + 15, yend = `Weight (lbs)`, x = Day - 4, y = `Weight (lbs)` + 0.4),
arrow = arrow(type = "closed", length = unit(0.1, "inches"), ends = "last"), color = "black") +
geom_text(data = subset(daily_weight, Day == as.Date("2024-05-20")),
aes(label = "Period of stinky diarrheas due to antiviral :(", x = Day,  y = 10.65), size = 2, vjust = 0) +
geom_segment(data = subset(daily_weight, Day == as.Date("2024-05-20")),
aes(xend = Day, yend = `Weight (lbs)` + 0.50, x = Day, y = 10.55),
arrow = arrow(type = "closed", length = unit(0.1, "inches"), ends = "last"), color = "black") +
labs(x = "Date",
y = "Weight (lbs)",
title = "Jasper's Daily Weight (lbs)",
subtitle = "Healthy Weight [11, 12]; 11.5 is average of the interval"
) +
scale_colour_manual(values = c("Y" = "red", "N" = "black")) +
scale_y_continuous(expand = c(0, 0), limits = c(7, 15),
breaks = c(7, 8, 9, 10, 11, 11.5, 12, 13, 14, 15)) +
# scale_y_continuous(expand = c(0, 0), limits = c(0, 15)) +
scale_x_date(date_breaks = "4 days", date_labels = "%m/%d/%Y") +
theme_clean() +
theme(axis.text.x = element_text(angle = 45, hjust = 1),legend.position = "none")
p2
# time-series of daily weights
p2 <- daily_weight %>%
filter(!is.na(`Weight (lbs)`)) %>% # filter after May 5th, 2024 and exclude NAs
ggplot(aes(x = Day, y = `Weight (lbs)`)) +
geom_hline(aes(yintercept = 11), color = "red", linetype = "dashed", size = 1.5) +
geom_hline(aes(yintercept = (11 + 12) / 2), color = "orange", linetype = "dashed", size = 1.5) + # healthy weight between [11.25, 12] (lbs) add average of two intervals as reference line
geom_hline(aes(yintercept = 12), color = "green", linetype = "dashed", size = 1.5) +
geom_hline(aes(yintercept = 9), color = "red", linetype = "dashed", size = 1.5) +
# geom_vline(data = weeks, aes(xintercept = Day), linetype = "dashed", color = "lightgrey") +
geom_point(size = 2, color = "black") +
geom_line(size = 1.0, color = "black") +
geom_line(aes(y = rollmean(`Weight (lbs)`, 7, na.pad = TRUE)), color = "blue", linetype = "dashed", size = 0.7) +
geom_point(aes(color = factor(is_week_max_date)), size = 2) +
geom_text(data = subset(daily_weight, Day == as.Date("2024-05-12")),
aes(label = "Red dots indicates end of week", x = Day - 3, y = `Weight (lbs)` + 0.5), size = 3, vjust = 0) +
geom_segment(data = subset(daily_weight, Day == as.Date("2024-05-07")),
aes(xend = Day, yend = `Weight (lbs)`, x = Day - 4, y = `Weight (lbs)` + 0.4),
arrow = arrow(type = "closed", length = unit(0.1, "inches"), ends = "last"), color = "black") +
geom_text(data = subset(daily_weight, Day == as.Date("2024-05-20")),
aes(label = "Period of stinky diarrheas due to antiviral :(", x = Day,  y = 10.65), size = 2, vjust = 0) +
geom_segment(data = subset(daily_weight, Day == as.Date("2024-05-20")),
aes(xend = Day, yend = `Weight (lbs)` + 0.50, x = Day, y = 10.55),
arrow = arrow(type = "closed", length = unit(0.1, "inches"), ends = "last"), color = "black") +
labs(x = "Date",
y = "Weight (lbs)",
title = "Jasper's Daily Weight (lbs)",
subtitle = "Healthy Weight [11, 12]; 11.5 is average of the interval"
) +
scale_colour_manual(values = c("Y" = "red", "N" = "black")) +
scale_y_continuous(expand = c(0, 0), limits = c(7, 15),
breaks = c(7, 8, 9, 10, 11, 11.5, 12, 13, 14, 15)) +
# scale_y_continuous(expand = c(0, 0), limits = c(0, 15)) +
scale_x_date(date_breaks = "4 days", date_labels = "%m/%d/%Y") +
theme_clean() +
theme(axis.text.x = element_text(angle = 45, hjust = 1),legend.position = "none")
p2
# time-series of daily weights
p2 <- daily_weight %>%
filter(!is.na(`Weight (lbs)`)) %>% # filter after May 5th, 2024 and exclude NAs
ggplot(aes(x = Day, y = `Weight (lbs)`)) +
geom_hline(aes(yintercept = 11), color = "red", linetype = "dashed", size = 1.5) +
geom_hline(aes(yintercept = (11 + 12) / 2), color = "orange", linetype = "dashed", size = 1.5) + # healthy weight between [11.25, 12] (lbs) add average of two intervals as reference line
geom_hline(aes(yintercept = 12), color = "green", linetype = "dashed", size = 1.5) +
geom_hline(aes(yintercept = 9), color = "red", linetype = "dashed", size = 1.5) +
# geom_vline(data = weeks, aes(xintercept = Day), linetype = "dashed", color = "lightgrey") +
geom_point(size = 2, color = "black") +
geom_line(size = 1.0, color = "black") +
geom_line(aes(y = rollmean(`Weight (lbs)`, 7, na.pad = TRUE)), color = "blue", linetype = "dashed", size = 0.7) +
geom_point(aes(color = factor(is_week_max_date)), size = 2) +
geom_text(data = subset(daily_weight, Day == as.Date("2024-05-12")),
aes(label = "Red dots indicates end of week", x = Day - 3, y = `Weight (lbs)` + 0.5), size = 3, vjust = 0) +
geom_segment(data = subset(daily_weight, Day == as.Date("2024-05-07")),
aes(xend = Day, yend = `Weight (lbs)`, x = Day - 4, y = `Weight (lbs)` + -.8),
arrow = arrow(type = "closed", length = unit(0.1, "inches"), ends = "last"), color = "black") +
geom_text(data = subset(daily_weight, Day == as.Date("2024-05-20")),
aes(label = "Period of stinky diarrheas due to antiviral :(", x = Day,  y = 10.65), size = 2, vjust = 0) +
geom_segment(data = subset(daily_weight, Day == as.Date("2024-05-20")),
aes(xend = Day, yend = `Weight (lbs)` + 0.50, x = Day, y = 10.55),
arrow = arrow(type = "closed", length = unit(0.1, "inches"), ends = "last"), color = "black") +
labs(x = "Date",
y = "Weight (lbs)",
title = "Jasper's Daily Weight (lbs)",
subtitle = "Healthy Weight [11, 12]; 11.5 is average of the interval"
) +
scale_colour_manual(values = c("Y" = "red", "N" = "black")) +
scale_y_continuous(expand = c(0, 0), limits = c(7, 15),
breaks = c(7, 8, 9, 10, 11, 11.5, 12, 13, 14, 15)) +
# scale_y_continuous(expand = c(0, 0), limits = c(0, 15)) +
scale_x_date(date_breaks = "4 days", date_labels = "%m/%d/%Y") +
theme_clean() +
theme(axis.text.x = element_text(angle = 45, hjust = 1),legend.position = "none")
p2
# time-series of daily weights
p2 <- daily_weight %>%
filter(!is.na(`Weight (lbs)`)) %>% # filter after May 5th, 2024 and exclude NAs
ggplot(aes(x = Day, y = `Weight (lbs)`)) +
geom_hline(aes(yintercept = 11), color = "red", linetype = "dashed", size = 1.5) +
geom_hline(aes(yintercept = (11 + 12) / 2), color = "orange", linetype = "dashed", size = 1.5) + # healthy weight between [11.25, 12] (lbs) add average of two intervals as reference line
geom_hline(aes(yintercept = 12), color = "green", linetype = "dashed", size = 1.5) +
geom_hline(aes(yintercept = 9), color = "red", linetype = "dashed", size = 1.5) +
# geom_vline(data = weeks, aes(xintercept = Day), linetype = "dashed", color = "lightgrey") +
geom_point(size = 2, color = "black") +
geom_line(size = 1.0, color = "black") +
geom_line(aes(y = rollmean(`Weight (lbs)`, 7, na.pad = TRUE)), color = "blue", linetype = "dashed", size = 0.7) +
geom_point(aes(color = factor(is_week_max_date)), size = 2) +
geom_text(data = subset(daily_weight, Day == as.Date("2024-05-12")),
aes(label = "Red dots indicates end of week", x = Day - 3, y = `Weight (lbs)` + 0.5), size = 3, vjust = 0) +
geom_segment(data = subset(daily_weight, Day == as.Date("2024-05-07")),
aes(xend = Day, yend = `Weight (lbs)`, x = Day - 4, y = `Weight (lbs)` + 0.8),
arrow = arrow(type = "closed", length = unit(0.1, "inches"), ends = "last"), color = "black") +
geom_text(data = subset(daily_weight, Day == as.Date("2024-05-20")),
aes(label = "Period of stinky diarrheas due to antiviral :(", x = Day,  y = 10.65), size = 2, vjust = 0) +
geom_segment(data = subset(daily_weight, Day == as.Date("2024-05-20")),
aes(xend = Day, yend = `Weight (lbs)` + 0.50, x = Day, y = 10.55),
arrow = arrow(type = "closed", length = unit(0.1, "inches"), ends = "last"), color = "black") +
labs(x = "Date",
y = "Weight (lbs)",
title = "Jasper's Daily Weight (lbs)",
subtitle = "Healthy Weight [11, 12]; 11.5 is average of the interval"
) +
scale_colour_manual(values = c("Y" = "red", "N" = "black")) +
scale_y_continuous(expand = c(0, 0), limits = c(7, 15),
breaks = c(7, 8, 9, 10, 11, 11.5, 12, 13, 14, 15)) +
# scale_y_continuous(expand = c(0, 0), limits = c(0, 15)) +
scale_x_date(date_breaks = "4 days", date_labels = "%m/%d/%Y") +
theme_clean() +
theme(axis.text.x = element_text(angle = 45, hjust = 1),legend.position = "none")
p2
# time-series of daily weights
p2 <- daily_weight %>%
filter(!is.na(`Weight (lbs)`)) %>% # filter after May 5th, 2024 and exclude NAs
ggplot(aes(x = Day, y = `Weight (lbs)`)) +
geom_hline(aes(yintercept = 11), color = "red", linetype = "dashed", size = 1.5) +
geom_hline(aes(yintercept = (11 + 12) / 2), color = "orange", linetype = "dashed", size = 1.5) + # healthy weight between [11.25, 12] (lbs) add average of two intervals as reference line
geom_hline(aes(yintercept = 12), color = "green", linetype = "dashed", size = 1.5) +
geom_hline(aes(yintercept = 9), color = "red", linetype = "dashed", size = 1.5) +
# geom_vline(data = weeks, aes(xintercept = Day), linetype = "dashed", color = "lightgrey") +
geom_point(size = 2, color = "black") +
geom_line(size = 1.0, color = "black") +
geom_line(aes(y = rollmean(`Weight (lbs)`, 7, na.pad = TRUE)), color = "blue", linetype = "dashed", size = 0.7) +
geom_point(aes(color = factor(is_week_max_date)), size = 2) +
geom_text(data = subset(daily_weight, Day == as.Date("2024-05-12")),
aes(label = "Red dots indicates end of week", x = Day - 3, y = `Weight (lbs)` + 0.5), size = 3, vjust = 0) +
geom_segment(data = subset(daily_weight, Day == as.Date("2024-05-07")),
aes(xend = Day, yend = `Weight (lbs)`, x = Day, y = `Weight (lbs)` + 0.8),
arrow = arrow(type = "closed", length = unit(0.1, "inches"), ends = "last"), color = "black") +
geom_text(data = subset(daily_weight, Day == as.Date("2024-05-20")),
aes(label = "Period of stinky diarrheas due to antiviral :(", x = Day,  y = 10.65), size = 2, vjust = 0) +
geom_segment(data = subset(daily_weight, Day == as.Date("2024-05-20")),
aes(xend = Day, yend = `Weight (lbs)` + 0.50, x = Day, y = 10.55),
arrow = arrow(type = "closed", length = unit(0.1, "inches"), ends = "last"), color = "black") +
labs(x = "Date",
y = "Weight (lbs)",
title = "Jasper's Daily Weight (lbs)",
subtitle = "Healthy Weight [11, 12]; 11.5 is average of the interval"
) +
scale_colour_manual(values = c("Y" = "red", "N" = "black")) +
scale_y_continuous(expand = c(0, 0), limits = c(7, 15),
breaks = c(7, 8, 9, 10, 11, 11.5, 12, 13, 14, 15)) +
# scale_y_continuous(expand = c(0, 0), limits = c(0, 15)) +
scale_x_date(date_breaks = "4 days", date_labels = "%m/%d/%Y") +
theme_clean() +
theme(axis.text.x = element_text(angle = 45, hjust = 1),legend.position = "none")
p2
# dynamically save ggplot
ggsave(
filename = paste0(here("images", "line", "jasper_weight_daily_time_series"), format(Sys.Date(), "_%Y_%m_%d"), ".png"),
plot = p2,
dpi = 600,
width = 14,
height = 8
)
# time-series of daily weights
p2 <- daily_weight %>%
filter(!is.na(`Weight (lbs)`)) %>% # filter after May 5th, 2024 and exclude NAs
ggplot(aes(x = Day, y = `Weight (lbs)`)) +
geom_hline(aes(yintercept = 11), color = "red", linetype = "dashed", size = 1.5) +
geom_hline(aes(yintercept = (11 + 12) / 2), color = "orange", linetype = "dashed", size = 1.5) + # healthy weight between [11.25, 12] (lbs) add average of two intervals as reference line
geom_hline(aes(yintercept = 12), color = "green", linetype = "dashed", size = 1.5) +
geom_hline(aes(yintercept = 9), color = "red", linetype = "dashed", size = 1.5) +
# geom_vline(data = weeks, aes(xintercept = Day), linetype = "dashed", color = "lightgrey") +
geom_point(size = 2, color = "black") +
geom_line(size = 1.0, color = "black") +
geom_line(aes(y = rollmean(`Weight (lbs)`, 7, na.pad = TRUE)), color = "blue", linetype = "dashed", size = 0.7) +
geom_point(aes(color = factor(is_week_max_date)), size = 2) +
geom_text(data = subset(daily_weight, Day == as.Date("2024-05-12")),
aes(label = "Red dots indicates end of week", x = Day - 3, y = `Weight (lbs)` + 0.5), size = 3, vjust = 0) +
geom_segment(data = subset(daily_weight, Day == as.Date("2024-05-07")),
aes(xend = Day, yend = `Weight (lbs)`, x = Day, y = `Weight (lbs)` + 0.8),
arrow = arrow(type = "closed", length = unit(0.1, "inches"), ends = "last"), color = "black") +
geom_text(data = subset(daily_weight, Day == as.Date("2024-05-20")),
aes(label = "Period of stinky diarrheas due to antiviral :(", x = Day,  y = 10.65), size = 3, vjust = 0) +
geom_segment(data = subset(daily_weight, Day == as.Date("2024-05-20")),
aes(xend = Day, yend = `Weight (lbs)` + 0.50, x = Day, y = 10.55),
arrow = arrow(type = "closed", length = unit(0.1, "inches"), ends = "last"), color = "black") +
labs(x = "Date",
y = "Weight (lbs)",
title = "Jasper's Daily Weight (lbs)",
subtitle = "Healthy Weight [11, 12]; 11.5 is average of the interval"
) +
scale_colour_manual(values = c("Y" = "red", "N" = "black")) +
scale_y_continuous(expand = c(0, 0), limits = c(7, 15),
breaks = c(7, 8, 9, 10, 11, 11.5, 12, 13, 14, 15)) +
# scale_y_continuous(expand = c(0, 0), limits = c(0, 15)) +
scale_x_date(date_breaks = "4 days", date_labels = "%m/%d/%Y") +
theme_clean() +
theme(axis.text.x = element_text(angle = 45, hjust = 1),legend.position = "none")
p2
# dynamically save ggplot
ggsave(
filename = paste0(here("images", "line", "jasper_weight_daily_time_series"), format(Sys.Date(), "_%Y_%m_%d"), ".png"),
plot = p2,
dpi = 600,
width = 14,
height = 8
)
# time-series of daily weights
p2 <- daily_weight %>%
filter(!is.na(`Weight (lbs)`)) %>% # filter after May 5th, 2024 and exclude NAs
ggplot(aes(x = Day, y = `Weight (lbs)`)) +
geom_hline(aes(yintercept = 11), color = "red", linetype = "dashed", size = 1.5) +
geom_hline(aes(yintercept = (11 + 12) / 2), color = "orange", linetype = "dashed", size = 1.5) + # healthy weight between [11.25, 12] (lbs) add average of two intervals as reference line
geom_hline(aes(yintercept = 12), color = "green", linetype = "dashed", size = 1.5) +
geom_hline(aes(yintercept = 9), color = "red", linetype = "dashed", size = 1.5) +
# geom_vline(data = weeks, aes(xintercept = Day), linetype = "dashed", color = "lightgrey") +
geom_point(size = 2, color = "black") +
geom_line(size = 1.0, color = "black") +
geom_line(aes(y = rollmean(`Weight (lbs)`, 7, na.pad = TRUE)), color = "blue", linetype = "dashed", size = 0.7) +
geom_point(aes(color = factor(is_week_max_date)), size = 2) +
geom_text(data = subset(daily_weight, Day == as.Date("2024-05-12")),
aes(label = "Red dots indicates end of week", x = Day - 3, y = `Weight (lbs)` + 0.5), size = 3, vjust = 0) +
geom_segment(data = subset(daily_weight, Day == as.Date("2024-05-07")),
aes(xend = Day, yend = `Weight (lbs)`, x = Day, y = `Weight (lbs)` + 0.8),
arrow = arrow(type = "closed", length = unit(0.1, "inches"), ends = "last"), color = "black") +
geom_text(data = subset(daily_weight, Day == as.Date("2024-05-20")),
aes(label = "Period of stinky diarrheas due to antiviral :(", x = Day,  y = 10.65), size = 2.5, vjust = 0) +
geom_segment(data = subset(daily_weight, Day == as.Date("2024-05-20")),
aes(xend = Day, yend = `Weight (lbs)` + 0.50, x = Day, y = 10.55),
arrow = arrow(type = "closed", length = unit(0.1, "inches"), ends = "last"), color = "black") +
labs(x = "Date",
y = "Weight (lbs)",
title = "Jasper's Daily Weight (lbs)",
subtitle = "Healthy Weight [11, 12]; 11.5 is average of the interval"
) +
scale_colour_manual(values = c("Y" = "red", "N" = "black")) +
scale_y_continuous(expand = c(0, 0), limits = c(7, 15),
breaks = c(7, 8, 9, 10, 11, 11.5, 12, 13, 14, 15)) +
# scale_y_continuous(expand = c(0, 0), limits = c(0, 15)) +
scale_x_date(date_breaks = "4 days", date_labels = "%m/%d/%Y") +
theme_clean() +
theme(axis.text.x = element_text(angle = 45, hjust = 1),legend.position = "none")
p2
# dynamically save ggplot
ggsave(
filename = paste0(here("images", "line", "jasper_weight_daily_time_series"), format(Sys.Date(), "_%Y_%m_%d"), ".png"),
plot = p2,
dpi = 600,
width = 14,
height = 8
)
# time-series of daily weights
p2 <- daily_weight %>%
filter(!is.na(`Weight (lbs)`)) %>% # filter after May 5th, 2024 and exclude NAs
ggplot(aes(x = Day, y = `Weight (lbs)`)) +
geom_hline(aes(yintercept = 11), color = "red", linetype = "dashed", size = 1.5) +
geom_hline(aes(yintercept = (11 + 12) / 2), color = "orange", linetype = "dashed", size = 1.5) + # healthy weight between [11.25, 12] (lbs) add average of two intervals as reference line
geom_hline(aes(yintercept = 12), color = "green", linetype = "dashed", size = 1.5) +
geom_hline(aes(yintercept = 9), color = "red", linetype = "dashed", size = 1.5) +
# geom_vline(data = weeks, aes(xintercept = Day), linetype = "dashed", color = "lightgrey") +
geom_point(size = 2, color = "black") +
geom_line(size = 1.0, color = "black") +
geom_line(aes(y = rollmean(`Weight (lbs)`, 7, na.pad = TRUE)), color = "blue", linetype = "dashed", size = 0.7) +
geom_point(aes(color = factor(is_week_max_date)), size = 2) +
geom_text(data = subset(daily_weight, Day == as.Date("2024-05-12")),
aes(label = "Red dots indicates end of week", x = Day - 3, y = `Weight (lbs)` + 0.5), size = 2.5, vjust = 0) +
geom_segment(data = subset(daily_weight, Day == as.Date("2024-05-07")),
aes(xend = Day, yend = `Weight (lbs)`, x = Day, y = `Weight (lbs)` + 0.8),
arrow = arrow(type = "closed", length = unit(0.1, "inches"), ends = "last"), color = "black") +
geom_text(data = subset(daily_weight, Day == as.Date("2024-05-20")),
aes(label = "Period of stinky diarrheas due to antiviral :(", x = Day,  y = 10.65), size = 2.5, vjust = 0) +
geom_segment(data = subset(daily_weight, Day == as.Date("2024-05-20")),
aes(xend = Day, yend = `Weight (lbs)` + 0.50, x = Day, y = 10.55),
arrow = arrow(type = "closed", length = unit(0.1, "inches"), ends = "last"), color = "black") +
labs(x = "Date",
y = "Weight (lbs)",
title = "Jasper's Daily Weight (lbs)",
subtitle = "Healthy Weight [11, 12]; 11.5 is average of the interval"
) +
scale_colour_manual(values = c("Y" = "red", "N" = "black")) +
scale_y_continuous(expand = c(0, 0), limits = c(7, 15),
breaks = c(7, 8, 9, 10, 11, 11.5, 12, 13, 14, 15)) +
# scale_y_continuous(expand = c(0, 0), limits = c(0, 15)) +
scale_x_date(date_breaks = "4 days", date_labels = "%m/%d/%Y") +
theme_clean() +
theme(axis.text.x = element_text(angle = 45, hjust = 1),legend.position = "none")
p2
# dynamically save ggplot
ggsave(
filename = paste0(here("images", "line", "jasper_weight_daily_time_series"), format(Sys.Date(), "_%Y_%m_%d"), ".png"),
plot = p2,
dpi = 600,
width = 14,
height = 8
)
source("C:/Users/natha/repos/jasper_data/scripts/jasper_weekly_daily_weight_plots_secure_script.R", echo=TRUE)
