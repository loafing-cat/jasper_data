breaks = c(7, 8, 9, 10, 11, 11.5, 12, 13, 14, 15)) +
# scale_y_continuous(expand = c(0, 0), limits = c(0, 15)) +
scale_x_date(date_breaks = "1 day", date_labels = "%m/%d/%Y") +
theme_clean() +
theme(axis.text.x = element_text(angle = 45, hjust = 1),
legend.position = "none")
p2
# dynamically save ggplot
ggsave(
filename = paste0(here("images", "line", "jasper_weight_daily_time_series"), format(Sys.Date(), "_%Y_%m_%d"), ".png"),
plot = p2,
dpi = 600,
width = 12,
height = 8
)
# violin plot
npg_palette_alpha_0.7 <- c("#E64B35B2", "#4DBBD5B2", "#00A087B2", "#3C5488B2", "#F39B7FB2", "#8491B4B2", "#91D1C2B2", "#DC0000B2", "#7E6148B2")
npg_palette_alpha_1 <-  c("#E64B35FF", "#4DBBD5FF", "#00A087FF", "#3C5488FF", "#F39B7FFF", "#8491B4FF", "#91D1C2FF", "#DC0000FF", "#7E6148FF")
custom_colors <- c("#F39B7FFF", "#4DBBD5FF", "#91D1C2FF", "#7fc8ff", "#8491B4B2","#d3860e", "#ffd145", "#A9C1A8", "#E0218A", "#ffbe79","#ff8c87" )
###
# violin with dotplot
p3 <- daily_weight %>%
filter(Day %in% complete_weeks$Day) %>%  # filter origin data to only where complete week data available
group_by(week) %>%
mutate(mean_weight = mean(`Weight (lbs)`, na.rm = TRUE), # compute mean/median weight to add to boxplots
median_weight = median(`Weight (lbs)`, na.rm = TRUE),
max_weight = max(`Weight (lbs)`, na.rm = TRUE)  # calculate max weight per week
) %>%
ungroup() %>%
ggplot(aes(x = week, y = `Weight (lbs)`, group = week, fill = factor(week))) +
geom_violin(aes(x = week, y = `Weight (lbs)`, fill = factor(week))) +
geom_boxplot(width = 0.1, color = "black", alpha = 0.2) +
# geom_point(position = position_jitter(width = 0.15), alpha = 0.8, size = 2) +
geom_dotplot(binaxis = "y", stackdir = "center", dotsize = 0.25, fill = "black") +
geom_point(aes(x = week, y = mean_weight), color = "red", size = 3) +
geom_line(aes(x = week, y = mean_weight, group = 1)) +
geom_text(
aes(x = week, y = max_weight + 0.25, label = sprintf('Mean: %.2f lbs', mean_weight)),  # adjust y using max_weight
vjust = 1,
color = 'red'
) +
geom_text(
aes(x = week, y = max_weight + 0.15, label = sprintf('Median: %.2f lbs', median_weight)),  # adjust y using max_weight
vjust = 1,
color = 'blue'
) +
# geom_text(
#   aes(x = week, y = mean_weight, label = sprintf('Mean: %.2f lbs', mean_weight)),
#   vjust = 2.5,
#   color = 'red'
# ) +
# geom_text(
#   aes(x = week, y = median_weight, label = sprintf('Median: %.2f lbs', median_weight)),
#   vjust = -1.5,
#   color = 'blue'
# ) +
geom_text(
data = mean_weights,
aes(x = midpoint, y = 9.7, label = sprintf('Change: %.2f lbs', delta)),
vjust = -0.5,
color = 'black'
) +
labs(x = 'Week',
y = 'Weight (lbs)',
title = "Jasper's Weight (lbs) Distribution",
subtitle = paste0(format(min(complete_weeks$Day), "%m/%d/%Y"), ' - ' , format(max(complete_weeks$Day), "%m/%d/%Y"))
) +
scale_fill_manual(values = custom_colors) +
scale_y_continuous(expand = c(0, 0), n.breaks = 8) +
scale_x_continuous(breaks = scales::pretty_breaks(n = length(unique(complete_weeks$week)))) +
# theme_minimal() +
theme_bw() +
# theme_clean() +
theme(legend.position = "none")
p3
###
# violin with dotplot
p3 <- daily_weight %>%
filter(Day %in% complete_weeks$Day) %>%  # filter origin data to only where complete week data available
group_by(week) %>%
mutate(mean_weight = mean(`Weight (lbs)`, na.rm = TRUE), # compute mean/median weight to add to boxplots
median_weight = median(`Weight (lbs)`, na.rm = TRUE),
max_weight = max(`Weight (lbs)`, na.rm = TRUE)  # calculate max weight per week
) %>%
ungroup() %>%
ggplot(aes(x = week, y = `Weight (lbs)`, group = week, fill = factor(week))) +
geom_violin(aes(x = week, y = `Weight (lbs)`, fill = factor(week))) +
geom_boxplot(width = 0.1, color = "black", alpha = 0.2) +
# geom_point(position = position_jitter(width = 0.15), alpha = 0.8, size = 2) +
geom_dotplot(binaxis = "y", stackdir = "center", dotsize = 0.25, fill = "black") +
geom_point(aes(x = week, y = mean_weight), color = "red", size = 3) +
geom_line(aes(x = week, y = mean_weight, group = 1)) +
geom_text(
aes(x = week, y = max_weight + 0.25, label = sprintf('Mean: %.2f lbs', mean_weight)),  # adjust y using max_weight
vjust = 1,
color = 'red'
) +
geom_text(
aes(x = week, y = max_weight + 0.15, label = sprintf('Median: %.2f lbs', median_weight)),  # adjust y using max_weight
vjust = 1,
color = 'blue'
) +
# geom_text(
#   aes(x = week, y = mean_weight, label = sprintf('Mean: %.2f lbs', mean_weight)),
#   vjust = 2.5,
#   color = 'red'
# ) +
# geom_text(
#   aes(x = week, y = median_weight, label = sprintf('Median: %.2f lbs', median_weight)),
#   vjust = -1.5,
#   color = 'blue'
# ) +
geom_text(
data = mean_weights,
aes(x = midpoint, y = 9.7, label = sprintf('Change: %.2f lbs', delta)),
vjust = -0.5,
color = 'black'
size = 50
p3
###
# violin with dotplot
p3 <- daily_weight %>%
filter(Day %in% complete_weeks$Day) %>%  # filter origin data to only where complete week data available
group_by(week) %>%
mutate(mean_weight = mean(`Weight (lbs)`, na.rm = TRUE), # compute mean/median weight to add to boxplots
median_weight = median(`Weight (lbs)`, na.rm = TRUE),
max_weight = max(`Weight (lbs)`, na.rm = TRUE)  # calculate max weight per week
) %>%
ungroup() %>%
ggplot(aes(x = week, y = `Weight (lbs)`, group = week, fill = factor(week))) +
geom_violin(aes(x = week, y = `Weight (lbs)`, fill = factor(week))) +
geom_boxplot(width = 0.1, color = "black", alpha = 0.2) +
# geom_point(position = position_jitter(width = 0.15), alpha = 0.8, size = 2) +
geom_dotplot(binaxis = "y", stackdir = "center", dotsize = 0.25, fill = "black") +
geom_point(aes(x = week, y = mean_weight), color = "red", size = 3) +
geom_line(aes(x = week, y = mean_weight, group = 1)) +
geom_text(
aes(x = week, y = max_weight + 0.25, label = sprintf('Mean: %.2f lbs', mean_weight)),  # adjust y using max_weight
vjust = 1,
color = 'red'
) +
geom_text(
aes(x = week, y = max_weight + 0.15, label = sprintf('Median: %.2f lbs', median_weight)),  # adjust y using max_weight
vjust = 1,
color = 'blue'
) +
# geom_text(
#   aes(x = week, y = mean_weight, label = sprintf('Mean: %.2f lbs', mean_weight)),
#   vjust = 2.5,
#   color = 'red'
# ) +
# geom_text(
#   aes(x = week, y = median_weight, label = sprintf('Median: %.2f lbs', median_weight)),
#   vjust = -1.5,
#   color = 'blue'
# ) +
geom_text(
data = mean_weights,
aes(x = midpoint, y = 9.7, label = sprintf('Change: %.2f lbs', delta)),
vjust = -0.5,
color = 'black'
size = 100
p3
###
# violin with dotplot
p3 <- daily_weight %>%
filter(Day %in% complete_weeks$Day) %>%  # filter origin data to only where complete week data available
group_by(week) %>%
mutate(mean_weight = mean(`Weight (lbs)`, na.rm = TRUE), # compute mean/median weight to add to boxplots
median_weight = median(`Weight (lbs)`, na.rm = TRUE),
max_weight = max(`Weight (lbs)`, na.rm = TRUE)  # calculate max weight per week
) %>%
ungroup() %>%
ggplot(aes(x = week, y = `Weight (lbs)`, group = week, fill = factor(week))) +
geom_violin(aes(x = week, y = `Weight (lbs)`, fill = factor(week))) +
geom_boxplot(width = 0.1, color = "black", alpha = 0.2) +
# geom_point(position = position_jitter(width = 0.15), alpha = 0.8, size = 2) +
geom_dotplot(binaxis = "y", stackdir = "center", dotsize = 0.25, fill = "black") +
geom_point(aes(x = week, y = mean_weight), color = "red", size = 3) +
geom_line(aes(x = week, y = mean_weight, group = 1)) +
geom_text(
aes(x = week, y = max_weight + 0.25, label = sprintf('Mean: %.2f lbs', mean_weight)),  # adjust y using max_weight
vjust = 1,
color = 'red'
) +
geom_text(
aes(x = week, y = max_weight + 0.15, label = sprintf('Median: %.2f lbs', median_weight)),  # adjust y using max_weight
vjust = 1,
color = 'blue'
) +
# geom_text(
#   aes(x = week, y = mean_weight, label = sprintf('Mean: %.2f lbs', mean_weight)),
#   vjust = 2.5,
#   color = 'red'
# ) +
# geom_text(
#   aes(x = week, y = median_weight, label = sprintf('Median: %.2f lbs', median_weight)),
#   vjust = -1.5,
#   color = 'blue'
# ) +
geom_text(
data = mean_weights,
aes(x = midpoint, y = 9.7, label = sprintf('Change: %.2f lbs', delta)),
vjust = -0.5,
color = 'black',
size = 50
) +
labs(x = 'Week',
y = 'Weight (lbs)',
title = "Jasper's Weight (lbs) Distribution",
subtitle = paste0(format(min(complete_weeks$Day), "%m/%d/%Y"), ' - ' , format(max(complete_weeks$Day), "%m/%d/%Y"))
) +
scale_fill_manual(values = custom_colors) +
scale_y_continuous(expand = c(0, 0), n.breaks = 8) +
scale_x_continuous(breaks = scales::pretty_breaks(n = length(unique(complete_weeks$week)))) +
# theme_minimal() +
theme_bw() +
# theme_clean() +
theme(legend.position = "none")
p3
###
# violin with dotplot
p3 <- daily_weight %>%
filter(Day %in% complete_weeks$Day) %>%  # filter origin data to only where complete week data available
group_by(week) %>%
mutate(mean_weight = mean(`Weight (lbs)`, na.rm = TRUE), # compute mean/median weight to add to boxplots
median_weight = median(`Weight (lbs)`, na.rm = TRUE),
max_weight = max(`Weight (lbs)`, na.rm = TRUE)  # calculate max weight per week
) %>%
ungroup() %>%
ggplot(aes(x = week, y = `Weight (lbs)`, group = week, fill = factor(week))) +
geom_violin(aes(x = week, y = `Weight (lbs)`, fill = factor(week))) +
geom_boxplot(width = 0.1, color = "black", alpha = 0.2) +
# geom_point(position = position_jitter(width = 0.15), alpha = 0.8, size = 2) +
geom_dotplot(binaxis = "y", stackdir = "center", dotsize = 0.25, fill = "black") +
geom_point(aes(x = week, y = mean_weight), color = "red", size = 3) +
geom_line(aes(x = week, y = mean_weight, group = 1)) +
geom_text(
aes(x = week, y = max_weight + 0.25, label = sprintf('Mean: %.2f lbs', mean_weight)),  # adjust y using max_weight
vjust = 1,
color = 'red'
) +
geom_text(
aes(x = week, y = max_weight + 0.15, label = sprintf('Median: %.2f lbs', median_weight)),  # adjust y using max_weight
vjust = 1,
color = 'blue'
) +
# geom_text(
#   aes(x = week, y = mean_weight, label = sprintf('Mean: %.2f lbs', mean_weight)),
#   vjust = 2.5,
#   color = 'red'
# ) +
# geom_text(
#   aes(x = week, y = median_weight, label = sprintf('Median: %.2f lbs', median_weight)),
#   vjust = -1.5,
#   color = 'blue'
# ) +
geom_text(
data = mean_weights,
aes(x = midpoint, y = 9.7, label = sprintf('Change: %.2f lbs', delta)),
vjust = -0.5,
color = 'black',
size = 10
) +
labs(x = 'Week',
y = 'Weight (lbs)',
title = "Jasper's Weight (lbs) Distribution",
subtitle = paste0(format(min(complete_weeks$Day), "%m/%d/%Y"), ' - ' , format(max(complete_weeks$Day), "%m/%d/%Y"))
) +
scale_fill_manual(values = custom_colors) +
scale_y_continuous(expand = c(0, 0), n.breaks = 8) +
scale_x_continuous(breaks = scales::pretty_breaks(n = length(unique(complete_weeks$week)))) +
# theme_minimal() +
theme_bw() +
# theme_clean() +
theme(legend.position = "none")
p3
###
# violin with dotplot
p3 <- daily_weight %>%
filter(Day %in% complete_weeks$Day) %>%  # filter origin data to only where complete week data available
group_by(week) %>%
mutate(mean_weight = mean(`Weight (lbs)`, na.rm = TRUE), # compute mean/median weight to add to boxplots
median_weight = median(`Weight (lbs)`, na.rm = TRUE),
max_weight = max(`Weight (lbs)`, na.rm = TRUE)  # calculate max weight per week
) %>%
ungroup() %>%
ggplot(aes(x = week, y = `Weight (lbs)`, group = week, fill = factor(week))) +
geom_violin(aes(x = week, y = `Weight (lbs)`, fill = factor(week))) +
geom_boxplot(width = 0.1, color = "black", alpha = 0.2) +
# geom_point(position = position_jitter(width = 0.15), alpha = 0.8, size = 2) +
geom_dotplot(binaxis = "y", stackdir = "center", dotsize = 0.25, fill = "black") +
geom_point(aes(x = week, y = mean_weight), color = "red", size = 3) +
geom_line(aes(x = week, y = mean_weight, group = 1)) +
geom_text(
aes(x = week, y = max_weight + 0.25, label = sprintf('Mean: %.2f lbs', mean_weight)),  # adjust y using max_weight
vjust = 1,
color = 'red'
) +
geom_text(
aes(x = week, y = max_weight + 0.15, label = sprintf('Median: %.2f lbs', median_weight)),  # adjust y using max_weight
vjust = 1,
color = 'blue'
) +
# geom_text(
#   aes(x = week, y = mean_weight, label = sprintf('Mean: %.2f lbs', mean_weight)),
#   vjust = 2.5,
#   color = 'red'
# ) +
# geom_text(
#   aes(x = week, y = median_weight, label = sprintf('Median: %.2f lbs', median_weight)),
#   vjust = -1.5,
#   color = 'blue'
# ) +
geom_text(
data = mean_weights,
aes(x = midpoint, y = 9.7, label = sprintf('Change: %.2f lbs', delta)),
vjust = -0.5,
color = 'black'
) +
labs(x = 'Week',
y = 'Weight (lbs)',
title = "Jasper's Weight (lbs) Distribution",
subtitle = paste0(format(min(complete_weeks$Day), "%m/%d/%Y"), ' - ' , format(max(complete_weeks$Day), "%m/%d/%Y"))
) +
scale_fill_manual(values = custom_colors) +
scale_y_continuous(expand = c(0, 0), n.breaks = 8) +
scale_x_continuous(breaks = scales::pretty_breaks(n = length(unique(complete_weeks$week)))) +
# theme_minimal() +
theme_bw() +
# theme_clean() +
theme(legend.position = "none")
p3
###
# violin with dotplot
p3 <- daily_weight %>%
filter(Day %in% complete_weeks$Day) %>%  # filter origin data to only where complete week data available
group_by(week) %>%
mutate(mean_weight = mean(`Weight (lbs)`, na.rm = TRUE), # compute mean/median weight to add to boxplots
median_weight = median(`Weight (lbs)`, na.rm = TRUE),
max_weight = max(`Weight (lbs)`, na.rm = TRUE)  # calculate max weight per week
) %>%
ungroup() %>%
ggplot(aes(x = week, y = `Weight (lbs)`, group = week, fill = factor(week))) +
geom_violin(aes(x = week, y = `Weight (lbs)`, fill = factor(week))) +
geom_boxplot(width = 0.1, color = "black", alpha = 0.2) +
# geom_point(position = position_jitter(width = 0.15), alpha = 0.8, size = 2) +
geom_dotplot(binaxis = "y", stackdir = "center", dotsize = 0.25, fill = "black") +
geom_point(aes(x = week, y = mean_weight), color = "red", size = 3) +
geom_line(aes(x = week, y = mean_weight, group = 1)) +
geom_text(
aes(x = week, y = max_weight + 0.25, label = sprintf('Mean: %.2f lbs', mean_weight)),  # adjust y using max_weight
vjust = 1,
color = 'red'
) +
geom_text(
aes(x = week, y = max_weight + 0.15, label = sprintf('Median: %.2f lbs', median_weight)),  # adjust y using max_weight
vjust = 1,
color = 'blue'
) +
# geom_text(
#   aes(x = week, y = mean_weight, label = sprintf('Mean: %.2f lbs', mean_weight)),
#   vjust = 2.5,
#   color = 'red'
# ) +
# geom_text(
#   aes(x = week, y = median_weight, label = sprintf('Median: %.2f lbs', median_weight)),
#   vjust = -1.5,
#   color = 'blue'
# ) +
geom_text(
data = mean_weights,
aes(x = midpoint, y = 9.7, label = sprintf('Change: %.2f lbs', delta)),
vjust = -0.5,
color = 'black',
size = 1
) +
labs(x = 'Week',
y = 'Weight (lbs)',
title = "Jasper's Weight (lbs) Distribution",
subtitle = paste0(format(min(complete_weeks$Day), "%m/%d/%Y"), ' - ' , format(max(complete_weeks$Day), "%m/%d/%Y"))
) +
scale_fill_manual(values = custom_colors) +
scale_y_continuous(expand = c(0, 0), n.breaks = 8) +
scale_x_continuous(breaks = scales::pretty_breaks(n = length(unique(complete_weeks$week)))) +
# theme_minimal() +
theme_bw() +
# theme_clean() +
theme(legend.position = "none")
p3
###
# violin with dotplot
p3 <- daily_weight %>%
filter(Day %in% complete_weeks$Day) %>%  # filter origin data to only where complete week data available
group_by(week) %>%
mutate(mean_weight = mean(`Weight (lbs)`, na.rm = TRUE), # compute mean/median weight to add to boxplots
median_weight = median(`Weight (lbs)`, na.rm = TRUE),
max_weight = max(`Weight (lbs)`, na.rm = TRUE)  # calculate max weight per week
) %>%
ungroup() %>%
ggplot(aes(x = week, y = `Weight (lbs)`, group = week, fill = factor(week))) +
geom_violin(aes(x = week, y = `Weight (lbs)`, fill = factor(week))) +
geom_boxplot(width = 0.1, color = "black", alpha = 0.2) +
# geom_point(position = position_jitter(width = 0.15), alpha = 0.8, size = 2) +
geom_dotplot(binaxis = "y", stackdir = "center", dotsize = 0.25, fill = "black") +
geom_point(aes(x = week, y = mean_weight), color = "red", size = 3) +
geom_line(aes(x = week, y = mean_weight, group = 1)) +
geom_text(
aes(x = week, y = max_weight + 0.25, label = sprintf('Mean: %.2f lbs', mean_weight)),  # adjust y using max_weight
vjust = 1,
color = 'red'
) +
geom_text(
aes(x = week, y = max_weight + 0.15, label = sprintf('Median: %.2f lbs', median_weight)),  # adjust y using max_weight
vjust = 1,
color = 'blue'
) +
# geom_text(
#   aes(x = week, y = mean_weight, label = sprintf('Mean: %.2f lbs', mean_weight)),
#   vjust = 2.5,
#   color = 'red'
# ) +
# geom_text(
#   aes(x = week, y = median_weight, label = sprintf('Median: %.2f lbs', median_weight)),
#   vjust = -1.5,
#   color = 'blue'
# ) +
geom_text(
data = mean_weights,
aes(x = midpoint, y = 9.7, label = sprintf('Change: %.2f lbs', delta)),
vjust = -0.5,
color = 'black',
size = 5
) +
labs(x = 'Week',
y = 'Weight (lbs)',
title = "Jasper's Weight (lbs) Distribution",
subtitle = paste0(format(min(complete_weeks$Day), "%m/%d/%Y"), ' - ' , format(max(complete_weeks$Day), "%m/%d/%Y"))
) +
scale_fill_manual(values = custom_colors) +
scale_y_continuous(expand = c(0, 0), n.breaks = 8) +
scale_x_continuous(breaks = scales::pretty_breaks(n = length(unique(complete_weeks$week)))) +
# theme_minimal() +
theme_bw() +
# theme_clean() +
theme(legend.position = "none")
p3
###
# violin with dotplot
p3 <- daily_weight %>%
filter(Day %in% complete_weeks$Day) %>%  # filter origin data to only where complete week data available
group_by(week) %>%
mutate(mean_weight = mean(`Weight (lbs)`, na.rm = TRUE), # compute mean/median weight to add to boxplots
median_weight = median(`Weight (lbs)`, na.rm = TRUE),
max_weight = max(`Weight (lbs)`, na.rm = TRUE)  # calculate max weight per week
) %>%
ungroup() %>%
ggplot(aes(x = week, y = `Weight (lbs)`, group = week, fill = factor(week))) +
geom_violin(aes(x = week, y = `Weight (lbs)`, fill = factor(week))) +
geom_boxplot(width = 0.1, color = "black", alpha = 0.2) +
# geom_point(position = position_jitter(width = 0.15), alpha = 0.8, size = 2) +
geom_dotplot(binaxis = "y", stackdir = "center", dotsize = 0.25, fill = "black") +
geom_point(aes(x = week, y = mean_weight), color = "red", size = 3) +
geom_line(aes(x = week, y = mean_weight, group = 1)) +
geom_text(
aes(x = week, y = max_weight + 0.25, label = sprintf('Mean: %.2f lbs', mean_weight)),  # adjust y using max_weight
vjust = 1,
color = 'red'
) +
geom_text(
aes(x = week, y = max_weight + 0.15, label = sprintf('Median: %.2f lbs', median_weight)),  # adjust y using max_weight
vjust = 1,
color = 'blue'
) +
# geom_text(
#   aes(x = week, y = mean_weight, label = sprintf('Mean: %.2f lbs', mean_weight)),
#   vjust = 2.5,
#   color = 'red'
# ) +
# geom_text(
#   aes(x = week, y = median_weight, label = sprintf('Median: %.2f lbs', median_weight)),
#   vjust = -1.5,
#   color = 'blue'
# ) +
geom_text(
data = mean_weights,
aes(x = midpoint, y = 9.7, label = sprintf('Change: %.2f lbs', delta)),
vjust = -0.5,
color = 'black',
size = 3
) +
labs(x = 'Week',
y = 'Weight (lbs)',
title = "Jasper's Weight (lbs) Distribution",
subtitle = paste0(format(min(complete_weeks$Day), "%m/%d/%Y"), ' - ' , format(max(complete_weeks$Day), "%m/%d/%Y"))
) +
scale_fill_manual(values = custom_colors) +
scale_y_continuous(expand = c(0, 0), n.breaks = 8) +
scale_x_continuous(breaks = scales::pretty_breaks(n = length(unique(complete_weeks$week)))) +
# theme_minimal() +
theme_bw() +
# theme_clean() +
theme(legend.position = "none")
p3
# dynamically save ggplot
ggsave(
filename = paste0(here("images", "violin", "jasper_mean_weight_violin_weekly_time_series"), format(Sys.Date(), "_%Y_%m_%d"), ".png"),
plot = p3,
dpi = 600,
width = 12,
height = 8
)
